<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Family Birthday Calendar</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Playfair+Display:ital,wght@0,700;1,700&family=Caveat:wght@400;700&family=Montserrat:wght@300;400;700;900&family=Orbitron:wght@400;700;900&family=Quicksand:wght@300;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-image: none;
            --bg-color: #f8fafc;
            --card-bg: rgba(255, 255, 255, 0.9);
            --accent: #6366f1;
            --text-main: #1e293b;
            --text-muted: #64748b;
            --font-family: 'Inter', sans-serif;
            --border-radius: 1.25rem;
        }

        /* Themes with Backgrounds and Unique Fonts */
        .theme-modern {
            --bg-image: linear-gradient(135deg, #e0e7ff 0%, #f1f5f9 100%);
            --accent: #4f46e5;
            --font-family: 'Montserrat', sans-serif;
        }

        .theme-warm {
            --bg-image: url('https://images.unsplash.com/photo-1516550135131-fe3dcb0bedc7?auto=format&fit=crop&q=80&w=2000');
            --bg-color: #fdf6e3;
            --card-bg: rgba(253, 252, 240, 0.92);
            --accent: #b45309;
            --text-main: #451a03;
            --font-family: 'Caveat', cursive;
        }

        .theme-dark {
            --bg-image: url('https://images.unsplash.com/photo-1534796636912-3b95b3ab5986?auto=format&fit=crop&q=80&w=2000');
            --bg-color: #020617;
            --card-bg: rgba(15, 23, 42, 0.85);
            --accent: #38bdf8;
            --text-main: #f1f5f9;
            --text-muted: #94a3b8;
            --font-family: 'Orbitron', sans-serif;
        }

        .theme-spring {
            --bg-image: url('https://images.unsplash.com/photo-1490750967868-88aa4486c946?auto=format&fit=crop&q=80&w=2000');
            --card-bg: rgba(255, 255, 255, 0.85);
            --accent: #15803d;
            --text-main: #064e3b;
            --font-family: 'Quicksand', sans-serif;
        }

        .theme-serif {
            --bg-image: url('https://images.unsplash.com/photo-1513519245088-0e12902e5a38?auto=format&fit=crop&q=80&w=2000');
            --card-bg: rgba(255, 255, 255, 0.95);
            --accent: #431407;
            --text-main: #1c1917;
            --font-family: 'Playfair Display', serif;
        }

        body {
            background: var(--bg-image) fixed center center / cover;
            background-color: var(--bg-color);
            color: var(--text-main);
            font-family: var(--font-family);
            transition: all 0.5s ease;
            min-height: 100vh;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1.5rem;
        }

        .month-card {
            background: var(--card-bg);
            backdrop-filter: blur(12px);
            border-radius: var(--border-radius);
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            padding: 1.5rem;
            border: 1px solid rgba(255,255,255,0.2);
            transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            break-inside: avoid;
        }

        .month-card:hover {
            transform: translateY(-8px);
        }

        .month-title {
            font-size: 1.75rem;
            font-weight: 800;
            color: var(--accent);
            border-bottom: 3px solid var(--accent);
            margin-bottom: 1.25rem;
            padding-bottom: 0.5rem;
            text-transform: uppercase;
        }

        .person-avatar {
            width: 3.5rem;
            height: 3.5rem;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid var(--accent);
            background-color: var(--bg-color);
        }

        .theme-btn {
            padding: 0.6rem 1.2rem;
            border-radius: 9999px;
            font-size: 0.85rem;
            font-weight: 600;
            transition: all 0.2s;
            background: rgba(255,255,255,0.2);
            backdrop-filter: blur(5px);
            border: 1px solid rgba(0,0,0,0.1);
            font-family: 'Inter', sans-serif;
        }

        .theme-btn.active {
            background-color: var(--accent);
            color: white;
            border-color: var(--accent);
        }

        .input-field {
            background: rgba(255,255,255,0.9);
            border: 1px solid rgba(0,0,0,0.1);
            padding: 0.6rem;
            border-radius: 0.75rem;
            width: 100%;
        }

        /* Print Settings */
        @media print {
            @page {
                size: A4 landscape;
                margin: 10mm;
            }
            header, .no-print, #addForm-section, .theme-btn, .print-trigger-btn {
                display: none !important;
            }
            body {
                background: none !important;
                background-color: white !important;
                color: black !important;
                padding: 0 !important;
                margin: 0 !important;
                font-family: sans-serif !important;
            }
            .max-w-7xl {
                max-width: 100% !important;
            }
            .calendar-grid {
                display: grid !important;
                grid-template-columns: repeat(4, 1fr) !important;
                gap: 8mm !important;
            }
            .month-card {
                box-shadow: none !important;
                border: 0.5pt solid #ddd !important;
                background: white !important;
                backdrop-filter: none !important;
                page-break-inside: avoid;
                margin: 0 !important;
                padding: 4mm !important;
            }
            .month-title {
                font-size: 14pt !important;
                color: black !important;
                border-bottom: 2pt solid black !important;
                margin-bottom: 3mm !important;
            }
            .person-avatar {
                width: 30pt !important;
                height: 30pt !important;
                border: 1pt solid #ccc !important;
                print-color-adjust: exact;
            }
            h3 { font-size: 11pt !important; }
        }

        #modal-backdrop {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.6);
            backdrop-filter: blur(8px);
            z-index: 100;
            align-items: center;
            justify-content: center;
        }
    </style>
</head>
<body class="theme-modern p-4 md:p-8">

    <!-- Modal -->
    <div id="modal-backdrop">
        <div class="bg-white p-8 rounded-3xl max-w-md w-full mx-4 shadow-2xl" style="background-color: var(--card-bg); color: var(--text-main);">
            <h2 class="text-2xl font-bold mb-4">Edit Entry</h2>
            <form id="editForm" class="space-y-4">
                <input type="hidden" id="edit-id">
                <div>
                    <label class="block text-xs uppercase font-bold mb-1 opacity-60">Name</label>
                    <input type="text" id="edit-name" required class="input-field">
                </div>
                <div>
                    <label class="block text-xs uppercase font-bold mb-1 opacity-60">Birthday</label>
                    <input type="date" id="edit-dob" required class="input-field">
                </div>
                <div class="flex flex-wrap gap-2 pt-4">
                    <button type="submit" class="bg-indigo-600 text-white px-6 py-2 rounded-xl font-bold flex-1">Save</button>
                    <button type="button" onclick="removeMember()" class="bg-red-500 text-white px-6 py-2 rounded-xl font-bold">Delete</button>
                    <button type="button" onclick="closeModal()" class="px-6 py-2 border rounded-xl font-bold">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <header class="max-w-7xl mx-auto mb-12">
        <div class="flex flex-col md:flex-row md:items-end justify-between gap-8">
            <div class="bg-white/40 p-6 rounded-3xl backdrop-blur-md border border-white/40 shadow-xl">
                <h1 class="text-5xl font-extrabold tracking-tighter mb-2 italic">Family Calendar</h1>
                <p class="opacity-80 text-lg">Your family's journey, month by month.</p>
            </div>
            
            <div class="flex flex-col gap-3 items-end no-print">
                <div class="flex flex-wrap gap-2 p-2 rounded-2xl bg-black/5 backdrop-blur-sm border border-black/5">
                    <button onclick="setTheme('modern')" class="theme-btn active" id="btn-modern">Modern</button>
                    <button onclick="setTheme('warm')" class="theme-btn" id="btn-warm">Warm</button>
                    <button onclick="setTheme('dark')" class="theme-btn" id="btn-dark">Night</button>
                    <button onclick="setTheme('spring')" class="theme-btn" id="btn-spring">Spring</button>
                    <button onclick="setTheme('serif')" class="theme-btn" id="btn-serif">Classic</button>
                </div>
                <button onclick="triggerPrint()" class="bg-white/80 hover:bg-white text-black px-6 py-2 rounded-full font-bold shadow-lg transition-all flex items-center gap-2 print-trigger-btn">
                    üñ®Ô∏è Print Calendar
                </button>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto">
        <!-- Add Member Form -->
        <section id="addForm-section" class="mb-12 no-print bg-white/30 p-8 rounded-3xl border border-white/50 backdrop-blur-xl shadow-2xl">
            <h2 class="text-2xl font-bold mb-6 flex items-center gap-3">
                <span class="bg-white p-2 rounded-full shadow-inner">üë§</span> Add Someone New
            </h2>
            <form id="addForm" class="grid grid-cols-1 md:grid-cols-4 gap-6 items-end">
                <div>
                    <label class="block text-xs uppercase font-black mb-2 opacity-70">Full Name</label>
                    <input type="text" id="name" required class="input-field" placeholder="e.g. Aunt Sarah">
                </div>
                <div>
                    <label class="block text-xs uppercase font-black mb-2 opacity-70">Date of Birth</label>
                    <input type="date" id="dob" required class="input-field">
                </div>
                <div>
                    <label class="block text-xs uppercase font-black mb-2 opacity-70">Picture (Optional)</label>
                    <input type="file" id="photo" accept="image/*" class="input-field text-sm">
                </div>
                <button type="submit" class="bg-black text-white px-8 py-3 rounded-xl font-bold hover:scale-105 transition-transform shadow-xl">
                    Add Member
                </button>
            </form>
        </section>

        <!-- Calendar Display -->
        <div id="calendar-container" class="calendar-grid pb-20">
            <!-- Months injected here -->
        </div>
    </main>

    <script>
        const months = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
        
        let familyMembers = [];

        function setTheme(theme) {
            document.body.className = `theme-${theme} p-4 md:p-8`;
            document.querySelectorAll('.theme-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(`btn-${theme}`).classList.add('active');
        }

        function triggerPrint() {
            window.focus();
            setTimeout(() => {
                window.print();
            }, 250);
        }

        function openEditModal(id) {
            const member = familyMembers.find(m => m.id === id);
            if (!member) return;
            document.getElementById('edit-id').value = member.id;
            document.getElementById('edit-name').value = member.name;
            document.getElementById('edit-dob').value = member.rawDate;
            document.getElementById('modal-backdrop').style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('modal-backdrop').style.display = 'none';
        }

        function removeMember() {
            const id = document.getElementById('edit-id').value;
            familyMembers = familyMembers.filter(m => m.id !== id);
            closeModal();
            renderCalendar();
        }

        document.getElementById('editForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const id = document.getElementById('edit-id').value;
            const name = document.getElementById('edit-name').value;
            const dob = new Date(document.getElementById('edit-dob').value);
            const rawDate = document.getElementById('edit-dob').value;
            const index = familyMembers.findIndex(m => m.id === id);
            if (index !== -1) {
                familyMembers[index].name = name;
                familyMembers[index].month = dob.getUTCMonth();
                familyMembers[index].day = dob.getUTCDate();
                familyMembers[index].rawDate = rawDate;
            }
            closeModal();
            renderCalendar();
        });

        function renderCalendar() {
            const container = document.getElementById('calendar-container');
            container.innerHTML = '';

            months.forEach((monthName, index) => {
                const monthMembers = familyMembers
                    .filter(m => m.month === index)
                    .sort((a, b) => a.day - b.day);

                const monthCard = document.createElement('div');
                monthCard.className = 'month-card';
                
                let membersHtml = '';
                if (monthMembers.length === 0) {
                    membersHtml = `<p class="text-sm opacity-30 italic py-4">Quiet month...</p>`;
                } else {
                    membersHtml = monthMembers.map(m => `
                        <div onclick="openEditModal('${m.id}')" class="flex items-center gap-4 mb-5 group cursor-pointer hover:bg-black/5 p-2 -m-2 rounded-2xl transition-all">
                            <img src="${m.photo}" alt="${m.name}" class="person-avatar shadow-md group-hover:rotate-3 transition-transform">
                            <div class="overflow-hidden">
                                <h3 class="font-bold text-lg truncate leading-tight">${m.name}</h3>
                                <p class="text-xs font-black uppercase tracking-widest opacity-50">${m.day}${getOrdinal(m.day)}</p>
                            </div>
                        </div>
                    `).join('');
                }

                monthCard.innerHTML = `
                    <h2 class="month-title">${monthName}</h2>
                    <div class="members-list">${membersHtml}</div>
                `;
                container.appendChild(monthCard);
            });
        }

        function getOrdinal(d) {
            if (d > 3 && d < 21) return 'th';
            switch (d % 10) {
                case 1:  return "st";
                case 2:  return "nd";
                case 3:  return "rd";
                default: return "th";
            }
        }

        document.getElementById('addForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const name = document.getElementById('name').value;
            const rawDate = document.getElementById('dob').value;
            const dob = new Date(rawDate);
            const photoInput = document.getElementById('photo');
            if (isNaN(dob.getTime())) return;

            const addMember = (photoUrl) => {
                familyMembers.push({
                    id: Date.now().toString(),
                    name: name,
                    month: dob.getUTCMonth(),
                    day: dob.getUTCDate(),
                    rawDate: rawDate,
                    photo: photoUrl || `https://ui-avatars.com/api/?name=${encodeURIComponent(name)}&size=128&background=random&bold=true`
                });
                renderCalendar();
                e.target.reset();
            };

            if (photoInput.files && photoInput.files[0]) {
                const reader = new FileReader();
                reader.onload = (event) => addMember(event.target.result);
                reader.readAsDataURL(photoInput.files[0]);
            } else {
                addMember(null);
            }
        });

        renderCalendar();
    </script>
</body>
</html>
